
<!doctype html>
<html class="no-js" lang="en">
<head>
<!-- Meta Tags -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

<!-- Title -->
<title>Dashboard - JOEeXPRESS</title>

<!-- Favicon -->
<link rel="icon" href="images/JE Techhub logo - Copy.png">

<!-- Google Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<!-- Font Awesome CSS -->
<link rel="stylesheet" href="css/font-awesome.min.css">
<!-- icofont CSS -->
<link rel="stylesheet" href="css/icofont.css">

<!-- Auth Service -->
<script src="js/authService.js"></script>

<style>
    :root {
        --primary-color: #1A76D1;
        --secondary-color: #f8f9fa;
        --accent-color: #17a2b8;
        --text-dark: #343a40;
        --text-light: #6c757d;
        --success-color: #28a745;
        --warning-color: #ffc107;
        --danger-color: #dc3545;
        --border-radius: 10px;
        --box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        --transition: all 0.3s ease;
    }
    
    body {
        font-family: 'Poppins', sans-serif;
        background-color: #f5f7fa;
        color: var(--text-dark);
    }
    
    .header {
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    }
    
    .dashboard-container {
        padding: 40px 0;
    }
    
    .welcome-card {
        background: linear-gradient(135deg, var(--primary-color), #2980b9);
        border-radius: var(--border-radius);
        padding: 30px;
        margin-bottom: 30px;
        box-shadow: var(--box-shadow);
        color: white;
        position: relative;
        overflow: hidden;
    }
    
    .welcome-card::after {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 150px;
        height: 150px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 50%;
        transform: translate(50%, -50%);
    }
    
    .welcome-card h2 {
        font-weight: 700;
        margin-bottom: 15px;
    }
    
    .card {
        background: white;
        border-radius: var(--border-radius);
        padding: 25px;
        margin-bottom: 30px;
        box-shadow: var(--box-shadow);
        border: none;
        transition: var(--transition);
    }
    
    .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0, 0, 0, 0.1);
    }
    
    .card h3 {
        color: var(--primary-color);
        font-weight: 600;
        font-size: 1.4rem;
        margin-bottom: 20px;
        padding-bottom: 15px;
        border-bottom: 1px solid rgba(0, 0, 0, 0.05);
    }
    
    .profile-info p {
        display: flex;
        justify-content: space-between;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px dashed rgba(0, 0, 0, 0.05);
    }
    
    .profile-info p strong {
        color: var(--text-dark);
        font-weight: 600;
    }
    
    .profile-info p span {
        color: var(--text-light);
    }
    
    .progress-container {
        margin-bottom: 30px;
    }
    
    .progress-container h5 {
        font-size: 1.1rem;
        font-weight: 600;
        margin-bottom: 10px;
        display: flex;
        justify-content: space-between;
    }
    
    .progress-container h5 span {
        font-size: 0.9rem;
        color: var(--text-light);
        font-weight: normal;
    }
    
    .progress-bar-container {
        height: 20px;
        border-radius: 10px;
        background-color: #e9ecef;
        overflow: hidden;
        margin-bottom: 5px;
    }
    
    .progress-bar-fill {
        height: 100%;
        border-radius: 10px;
        background: linear-gradient(90deg, var(--primary-color), var(--accent-color));
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 0.7rem;
        font-weight: 600;
        transition: width 1s ease;
    }
    
    .loader-wrapper {
        position: fixed;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.95);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        top: 0;
        left: 0;
        transition: opacity 0.5s ease, visibility 0.5s ease;
    }

    .loader {
        width: 70px;
        height: 70px;
        border: 6px solid #f3f3f3;
        border-top: 6px solid var(--primary-color);
        border-radius: 50%;
        animation: spin 1.5s linear infinite;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    .hidden {
        opacity: 0;
        visibility: hidden;
    }
    
    .get-quote a {
        background: var(--primary-color);
        color: white;
        border-radius: 30px;
        padding: 10px 25px;
        font-weight: 500;
        transition: var(--transition);
    }
    
    .get-quote a:hover {
        background: #0d6efd;
        transform: translateY(-3px);
    }
    
    .footer {
        margin-top: 30px;
    }
    
    .copyright {
        padding: 25px 0;
    }
    
    @media (max-width: 768px) {
        .dashboard-container {
            padding: 20px 0;
        }
        
        .welcome-card {
            padding: 20px;
        }
        
        .card {
            padding: 15px;
        }
    }
</style>
</head>
<body>

<!-- Header Area -->
<header class="header">
<div class="header-inner bg-dark text-white">
<div class="container">
<div class="inner">
<div class="row align-items-center">
<div class="col-lg-3 col-md-3 col-12">
<!-- Start Logo -->
<div class="logo">
<a href="index.html"><img src="images/JE Techhub logo.png" alt="Logo"></a>
</div>
<!-- End Logo -->
<!-- Mobile Nav -->
<div class="mobile-nav"></div>
<!-- End Mobile Nav -->
</div>
<div class="col-lg-7 col-md-9 col-12">
<!-- Main Menu -->
<div class="main-menu">
<nav class="navigation">
<ul class="nav menu">
<li><a href="index.html">Home</a></li>
<li><a href="index.html#about">About Us</a></li>
<li><a href="programs.html">Programs</a></li>
<li><a href="contact.html">Contact Us</a></li>
</ul>
</nav>
</div>
<!--/ End Main Menu -->
</div>
<div class="col-lg-2 col-12">
<div class="get-quote">
<a href="#" class="btn" id="logoutButton">Logout</a>
</div>
</div>
</div>
</div>
</div>
</div>
</header>
<!-- End Header Area -->

<!-- Loading Spinner -->
<div class="loader-wrapper">
    <div class="loader"></div>
</div>

<!-- Dashboard Content -->
<section class="dashboard-container">
    <div class="container">
        <div class="welcome-card">
            <h2>Welcome, <span id="userFullName">Student</span>!</h2>
            <p>Track your learning progress and manage your personal information from your dashboard.</p>
        </div>
        
        <div class="row">
            <div class="col-lg-4 col-md-6">
                <div class="card">
                    <h3><i class="fa fa-user-circle-o me-2"></i> Profile Information</h3>
                    <div id="profileInfo" class="profile-info">
                        <p><strong>First Name:</strong> <span id="userFirstName"></span></p>
                        <p><strong>Last Name:</strong> <span id="userLastName"></span></p>
                        <p><strong>Email:</strong> <span id="userEmail"></span></p>
                        <p><strong>Enrolled Course:</strong> <span id="userCourse"></span></p>
                        <p><strong>Registered On:</strong> <span id="userRegistrationDate"></span></p>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fa fa-bell me-2"></i> Announcements</h3>
                    <div class="announcements">
                        <div class="alert alert-info">
                            <strong>New Module Released!</strong> Check out the latest content in your course.
                        </div>
                        <div class="alert alert-success">
                            <strong>Upcoming Webinar:</strong> Join us this Friday for a special session with industry experts.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-lg-8 col-md-6">
                <div class="card">
                    <h3><i class="fa fa-graduation-cap me-2"></i> Course Progress</h3>
                    <div id="courseProgress">
                        <p class="text-center">Loading course progress...</p>
                    </div>
                </div>
                
                <div class="card">
                    <h3><i class="fa fa-calendar me-2"></i> Upcoming Sessions</h3>
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Advanced Programming Techniques
                            <span class="badge bg-primary rounded-pill">May 15</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            Database Management Workshop
                            <span class="badge bg-primary rounded-pill">May 22</span>
                        </li>
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            UI/UX Design Principles
                            <span class="badge bg-primary rounded-pill">May 30</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Footer Area -->
<footer class="footer">
<div class="copyright bg-dark text-white">
<div class="container">
<div class="row">
<div class="col-12">
<div class="copyright-content text-center">
<p>&copy; 2024 JOEeXPRESS TechHub | All Rights Reserved</p>
</div>
</div>
</div>
</div>
</div>
</footer>

<script>
// Function to format dates in a more readable format
function formatDate(dateString) {
    const date = new Date(dateString);
    return date.toLocaleDateString('en-US', { 
        year: 'numeric', 
        month: 'long', 
        day: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    });
}

// Function to format course display name
function formatCourseName(courseCode) {
    switch(courseCode) {
        case 'softwareDev': return 'Software Development';
        case 'dataAnalysis': return 'Data Analysis';
        case 'videoGraphics': return 'Video Editing & Graphics Design';
        case 'forex': return 'Forex Trading';
        case 'gadgets': return 'Gadgets/Sales and Repairs';
        case 'member': return 'Member';
        default: return courseCode;
    }
}

// Handle logout
document.getElementById('logoutButton').addEventListener('click', function(e) {
    e.preventDefault();
    authService.logout();
    window.location.href = 'index.html';
});

// Load user profile data
async function loadUserProfile() {
    try {
        document.querySelector('.loader-wrapper').classList.remove('hidden');
        
        // Try to get profile from local storage first
        let userProfile = authService.getUserProfile();
        
        // If token exists but no profile, fetch it from the server
        if (authService.getToken() && !userProfile) {
            userProfile = await authService.getProfile();
        }
        
        // Redirect to login if no valid auth session
        if (!userProfile) {
            window.location.href = 'getStarted.html';
            return;
        }
        
        // Update profile information
        document.getElementById('userFullName').textContent = userProfile.firstName + ' ' + userProfile.lastName;
        document.getElementById('userFirstName').textContent = userProfile.firstName;
        document.getElementById('userLastName').textContent = userProfile.lastName;
        document.getElementById('userEmail').textContent = userProfile.email;
        document.getElementById('userCourse').textContent = formatCourseName(userProfile.course);
        document.getElementById('userRegistrationDate').textContent = formatDate(userProfile.registrationDate);
        
        // Update course progress
        const progressContainer = document.getElementById('courseProgress');
        
        if (userProfile.progress && userProfile.progress.length > 0) {
            let progressHTML = '';
            
            userProfile.progress.forEach(progress => {
                const percentComplete = (progress.completed / progress.totalModules) * 100;
                
                progressHTML += `
                    <div class="progress-container">
                        <h5>${formatCourseName(progress.course)} <span>${progress.completed} of ${progress.totalModules} modules completed</span></h5>
                        <div class="progress-bar-container">
                            <div class="progress-bar-fill" style="width: ${percentComplete}%">
                                ${percentComplete.toFixed(0)}%
                            </div>
                        </div>
                    </div>
                `;
            });
            
            progressContainer.innerHTML = progressHTML;
            
            // Animate progress bars
            setTimeout(() => {
                const progressBars = document.querySelectorAll('.progress-bar-fill');
                progressBars.forEach(bar => {
                    const width = bar.style.width;
                    bar.style.width = '0%';
                    setTimeout(() => {
                        bar.style.width = width;
                    }, 200);
                });
            }, 300);
            
        } else {
            progressContainer.innerHTML = '<div class="alert alert-info">No course progress available yet. Start your learning journey today!</div>';
        }
    } catch (error) {
        console.error('Error loading profile:', error);
        if (error.message.includes('token') || error.message.includes('login')) {
            // Redirect to login page if authentication issue
            window.location.href = 'getStarted.html';
        }
    } finally {
        document.querySelector('.loader-wrapper').classList.add('hidden');
    }
}

// Check authentication on page load
window.addEventListener('load', function() {
    if (!authService.isAuthenticated()) {
        window.location.href = 'getStarted.html';
        return;
    }
    
    loadUserProfile();
});
</script>

<!-- jquery Min JS -->
<script src="js/jquery.min.js"></script>
<!-- Bootstrap JS -->
<script src="js/bootstrap.min.js"></script>
</body>
</html>
